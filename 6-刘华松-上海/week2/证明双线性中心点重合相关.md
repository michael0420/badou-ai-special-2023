## **要证明双线性插值中心重合，需要理解双线性插值的定义和工作原理。**

**双线性插值是一种基于四个最近邻像素值的插值方法，在计算缩放后像素的颜色时，会根据其在原始图像中的位置，利用最近邻四个像素的颜色进行插值计算。这四个最近邻像素分别位于插值像素的左上、左下、右上和右下方。**

**当双线性插值中心重合时，即原始图像的像素点和目标图像的像素点重合时，双线性插值的计算方法将会退化为最邻近插值。这是因为此时最近邻的四个像素点都是重合的像素点，而插值系数u和v都为0，因此插值结果将直接采用原始图像中的该像素点的颜色值。**

**换句话说，当双线性插值中心重合时，计算公式中的插值系数u和v都等于0，从而导致计算四个最近邻颜色的系数都变成了0或1，使得插值计算退化为最邻近插值。**

**所以，通过上述推理可得，双线性插值中心重合时，其计算结果与最邻近插值相同。**



## 双线性插值的计算公式如下：

设原始图像中的四个最近邻像素为 P1、P2、P3 和 P4 ，它们的颜色值分别为 C1、C2、C3 和 C4，而要求得的插值像素为 P ，其坐标为 (x,y) 。又设 u 和 v 分别为 x 和 y 相对于 P1 和 P2 的偏移量，则

```
R1 = C1 * (1 - u) + C2 * u
R2 = C3 * (1 - u) + C4 * u
P  = R1 * (1 - v) + R2 * v
```

其中，R1 和 R2 是在 x 方向上对 C1、C2 和 C3、C4 进行插值后得到的两个中间结果。

如果插值像素 P 刚好是原像素位置 (x,y) 时，即 u=0，v=0，则有：

```
R1 = C1 * (1 - 0) + C2 * 0 = C1
R2 = C3 * (1 - 0) + C4 * 0 = C3
P  = R1 * (1 - 0) + R2 * 0 = R1 = C1
```

这时，P 的值等于 P1 的颜色值 C1 ，即结果退化为最近邻插值。

因此，当双线性插值中心重合时，即原始图像的像素点和目标图像的像素点重合时，插值系数 u 和 v 都为0，则 R1 和 R2 分别等于 C1 和 C3 。插值计算公式简化为：

```
P  = C1 * (1 - 0) + C3 * 0 = C1
```

此时，双线性插值的结果与最近邻插值相同。



## 0.5偏移量问题备注

在双线性插值的计算公式中，对于插值系数 u 和 v 的计算，通常会加上 0.5 的偏移量。这是为了防止计算误差和取整误差导致的边界问题。

在双线性插值的计算中，插值的目的是通过四个最近邻像素的颜色值进行加权平均来估计插值像素的颜色值。插值系数 u 和 v 是实际像素位置相对于最近邻像素位置的偏移量，通常是归一化的（即取值范围为 [0, 1]）。

然而，由于计算机中的像素坐标是以整数值表示的，这就会导致插值系数的计算存在取整误差。假设按照上述公式计算得到的插值系数为 u = 0.25 ，那么实际上应该取最近邻像素的 0.25 的位置，但由于取整误差，可能会取到 0 或 0.5 的位置，这会导致插值结果偏离真实值。

为了解决这个问题，可以在插值系数的计算时加上 0.5 的偏移量，即：

```
u = x * scale - source_x1 + 0.5
v = y * scale - source_y1 + 0.5
```

这样，加上偏移量后的插值系数会更接近实际的位置，可以减小取整误差带来的影响，从而得到更准确的插值结果。

需要注意的是，加上 0.5 的偏移量只是一种常用的技巧，实际上可能存在其他处理边界和误差的方法，具体的应用可以根据实际情况灵活调整。



